<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>×“×” ×•×™× ×¦'×™ â€” ×œ×•×‘×™</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{--gold:#c9a84c;--gl:#e2c06a;--gd:rgba(201,168,76,.12);--gb:rgba(201,168,76,.28);--k:#09090b;--d1:#111214;--d2:#161719;--d3:#1c1e22;--d4:#242629;--d5:#2e3035;--tx:#f0ead8;--t2:#a89878;--t3:#5c5444;--re:#e05252;--gr:#4caf7a;--bl:#5b8ef0;--r:12px;--r2:8px;--sh:0 8px 40px rgba(0,0,0,.6)}
body{font-family:'Heebo',sans-serif;background:var(--k);color:var(--tx);min-height:100vh;direction:rtl}
body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse 70% 50% at 15% -5%,rgba(201,168,76,.05) 0%,transparent 55%);pointer-events:none}
#login{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;padding:20px;z-index:99}
.lbox{background:var(--d1);border:1px solid var(--gb);border-radius:20px;width:100%;max-width:360px;padding:36px;box-shadow:var(--sh);position:relative}
.lbox::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(to right,transparent,var(--gold),transparent)}
.ltop{text-align:center;margin-bottom:28px}
.ldv{font-family:'Playfair Display',serif;font-size:48px;font-weight:900;color:var(--gold);line-height:1}
.lname{font-family:'Playfair Display',serif;font-size:16px;color:var(--t2);margin:4px 0 2px}
.lsub{font-size:10px;letter-spacing:3px;color:var(--t3);text-transform:uppercase}
.lfg{margin-bottom:12px}
.lfl{display:block;font-size:11px;font-weight:600;color:var(--t2);margin-bottom:5px}
.linp{width:100%;background:var(--d3);border:1px solid var(--d4);border-radius:var(--r2);padding:11px 14px;color:var(--tx);font-family:inherit;font-size:14px;direction:rtl;outline:none;transition:border-color .18s}
.linp:focus{border-color:var(--gb);background:var(--d2)}
.linp::placeholder{color:var(--t3)}
.lerr{color:var(--re);font-size:12px;text-align:center;height:18px;margin-bottom:8px}
.lbtn{width:100%;background:var(--gold);color:var(--k);border:none;padding:13px;border-radius:var(--r2);font-size:15px;font-weight:700;cursor:pointer;font-family:inherit;transition:background .18s}
.lbtn:hover{background:var(--gl)}
.lload{text-align:center;font-size:12px;color:var(--t3);margin-top:10px;min-height:18px}
#app{display:block}
.topbar{background:var(--d1);border-bottom:1px solid var(--gb);padding:0 24px;height:60px;display:flex;align-items:center;gap:14px;position:sticky;top:0;z-index:50;backdrop-filter:blur(14px)}
.tlogo{font-family:'Playfair Display',serif;font-size:20px;font-weight:700;color:var(--gold)}
.tright{margin-right:auto;display:flex;align-items:center;gap:10px}
.clk{font-size:12px;color:var(--t2);background:var(--d3);border:1px solid var(--d5);padding:5px 12px;border-radius:30px}
.tunm{font-size:13px;color:var(--t2)}
.tbtn{background:transparent;border:1px solid var(--d5);color:var(--t2);padding:6px 14px;border-radius:var(--r2);font-size:12px;font-weight:600;cursor:pointer;font-family:inherit;transition:all .18s}
.tbtn:hover{border-color:rgba(224,82,82,.4);color:var(--re)}
.wrap{max-width:1100px;margin:0 auto;padding:24px 20px;display:flex;flex-direction:column;gap:20px}
.tabs{display:flex;border-bottom:1px solid var(--d4);gap:4px}
.tab{padding:10px 20px;font-size:13px;font-weight:600;color:var(--t2);cursor:pointer;border-bottom:2px solid transparent;transition:all .18s;margin-bottom:-1px}
.tab:hover{color:var(--tx)}.tab.on{color:var(--gold);border-bottom-color:var(--gold)}
.sec{display:none}.sec.on{display:flex;flex-direction:column;gap:16px}
.sg{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.sc{background:var(--d1);border:1px solid var(--d4);border-radius:var(--r);padding:16px;text-align:center;transition:all .18s}
.sc.hl{border-color:var(--gb)}.sc:hover{transform:translateY(-2px)}
.scn{font-family:'Playfair Display',serif;font-size:28px;font-weight:700;color:var(--tx)}
.sc.hl .scn{color:var(--gold)}.scl{font-size:11px;color:var(--t3);margin-top:3px}
.two{display:grid;grid-template-columns:1fr 280px;gap:16px}
.card{background:var(--d1);border:1px solid var(--d4);border-radius:var(--r);overflow:hidden}
.ch{padding:14px 18px;border-bottom:1px solid var(--d4);display:flex;align-items:center;justify-content:space-between}
.ch h3{font-family:'Playfair Display',serif;font-size:15px;font-weight:700}
.bln{background:none;border:none;color:var(--gold);font-size:12px;cursor:pointer;font-family:inherit;opacity:.75}
.bln:hover{opacity:1}
.cb{padding:18px;display:flex;flex-direction:column;gap:12px}
.frow{display:flex;gap:9px;flex-wrap:wrap;align-items:center}
.sw2{position:relative;flex:1;min-width:180px}
.si{position:absolute;right:11px;top:50%;transform:translateY(-50%);color:var(--t3);font-size:13px;pointer-events:none}
.fi{width:100%;background:var(--d2);border:1px solid var(--d4);border-radius:var(--r2);padding:9px 32px 9px 11px;color:var(--tx);font-family:inherit;font-size:13px;direction:rtl;outline:none}
.fi:focus{border-color:var(--gb)}.fi::placeholder{color:var(--t3)}
.fs{background:var(--d2);border:1px solid var(--d4);border-radius:var(--r2);padding:9px 11px;color:var(--tx);font-family:inherit;font-size:12.5px;cursor:pointer;direction:rtl;outline:none}
.fs:focus{border-color:var(--gb)}
.tw{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:13px}
thead th{background:var(--d2);color:var(--t3);font-weight:600;font-size:10px;letter-spacing:1px;text-transform:uppercase;padding:10px 14px;text-align:right;border-bottom:1px solid var(--d4);white-space:nowrap}
tbody td{padding:11px 14px;border-bottom:1px solid rgba(255,255,255,.025);vertical-align:middle}
tbody tr:last-child td{border-bottom:none}
tbody tr:hover td{background:rgba(201,168,76,.03)}
.ec{text-align:center;color:var(--t3);padding:32px !important;font-size:13px}
.bdg{display:inline-flex;align-items:center;padding:3px 9px;border-radius:20px;font-size:11px;font-weight:600}
.bb{background:rgba(91,142,240,.1);color:var(--bl);border:1px solid rgba(91,142,240,.18)}
.bg{background:var(--gd);color:var(--gold);border:1px solid var(--gb)}
.bgr{background:rgba(76,175,122,.1);color:var(--gr);border:1px solid rgba(76,175,122,.18)}
.bgy{background:rgba(255,255,255,.04);color:var(--t2);border:1px solid var(--d5)}
.ic{background:none;border:none;cursor:pointer;padding:4px 7px;border-radius:5px;font-size:13px;color:var(--t2);transition:all .18s}
.ic.dl:hover{background:rgba(224,82,82,.1);color:var(--re)}
.fg{display:flex;flex-direction:column;gap:5px}
.fl{font-size:11px;font-weight:600;color:var(--t2)}
.inp{width:100%;background:var(--d3);border:1px solid var(--d4);border-radius:var(--r2);padding:9px 12px;color:var(--tx);font-family:inherit;font-size:13px;direction:rtl;outline:none;transition:border-color .18s}
.inp:focus{border-color:var(--gb);background:var(--d2)}
.inp[readonly]{opacity:.5;cursor:not-allowed}.inp::placeholder{color:var(--t3)}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.sbtn{background:var(--gold);color:var(--k);border:none;padding:10px 24px;border-radius:var(--r2);font-size:13px;font-weight:700;cursor:pointer;font-family:inherit;transition:all .18s}
.sbtn:hover{background:var(--gl)}.sbtn.w{width:100%;padding:12px}
.sbox{background:var(--d1);border:1px solid var(--gb);border-radius:var(--r);overflow:hidden}
.sbi{display:flex;align-items:center;gap:10px;padding:12px 16px;border-bottom:1px solid var(--d4)}
.sbico{font-size:16px;color:var(--gold)}
.sbinp{flex:1;background:none;border:none;color:var(--tx);font-family:inherit;font-size:15px;outline:none;direction:rtl}
.sbinp::placeholder{color:var(--t3)}
.sbcl{background:var(--d3);border:1px solid var(--d5);color:var(--t2);border-radius:5px;width:24px;height:24px;cursor:pointer;font-size:11px}
.sbtags{display:flex;gap:6px;padding:10px 16px;flex-wrap:wrap}
.stag{padding:4px 12px;border-radius:20px;font-size:11.5px;font-weight:600;cursor:pointer;color:var(--t2);border:1px solid var(--d5);transition:all .18s;user-select:none}
.stag:hover{border-color:var(--gb)}.stag.on{background:var(--gd);color:var(--gold);border-color:var(--gb)}
mark{background:rgba(201,168,76,.25);color:var(--gl);border-radius:3px;padding:0 2px}
.tcnt{font-size:12px;color:var(--t3);white-space:nowrap;align-self:center}
.fll{padding:12px 18px;display:flex;flex-direction:column;gap:9px}
.flr2{display:flex;align-items:center;gap:9px}
.fll2{width:60px;font-size:11px;color:var(--t2);font-weight:600;flex-shrink:0}
.flt{flex:1;height:5px;background:var(--d3);border-radius:3px;overflow:hidden}
.flf{height:100%;background:linear-gradient(to left,var(--gold),var(--gl));border-radius:3px;transition:width .7s ease}
.fln{width:20px;font-size:11px;color:var(--t3);flex-shrink:0;text-align:left}
.role-a{background:var(--gd);color:var(--gold);border:1px solid var(--gb);display:inline-flex;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:700}
.role-g{background:rgba(91,142,240,.1);color:var(--bl);border:1px solid rgba(91,142,240,.18);display:inline-flex;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:700}
.spinner{display:inline-block;width:16px;height:16px;border:2px solid var(--d5);border-top-color:var(--gold);border-radius:50%;animation:spin .7s linear infinite;vertical-align:middle;margin-left:6px}
@keyframes spin{to{transform:rotate(360deg)}}
.toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(80px);background:var(--d1);border:1px solid var(--d5);color:var(--tx);padding:10px 24px;border-radius:30px;font-size:13px;font-weight:500;z-index:9999;transition:transform .28s ease;white-space:nowrap;box-shadow:var(--sh);pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
.toast.ok{border-color:rgba(76,175,122,.35);color:var(--gr)}
.toast.er{border-color:rgba(224,82,82,.35);color:var(--re)}
@media(max-width:900px){.sg{grid-template-columns:repeat(2,1fr)}.two{grid-template-columns:1fr}}
@media(max-width:600px){.sg{grid-template-columns:1fr}.grid2{grid-template-columns:1fr}}

.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.stat{background:var(--d1);border:1px solid var(--d4);border-radius:var(--r);padding:16px;text-align:center}
.stat.hl{border-color:var(--gb)}
.stn{font-family:'Playfair Display',serif;font-size:28px;font-weight:700;color:var(--tx)}
.stat.hl .stn{color:var(--gold)}.stl{font-size:11px;color:var(--t3);margin-top:3px}
</style>
</head>
<body>

<div id="app">
  <header class="topbar">
    <span class="tlogo">×“×” ×•×™× ×¦'×™</span>
    <span class="clk" id="clk"></span>
    <div class="tright">
      <span class="tunm">×œ×•×‘×™</span>
    </div>
  </header>
  <div class="wrap">
    <div class="stats">
      <div class="stat hl"><div class="stn" id="sToday">0</div><div class="stl">ğŸ‘¤ ××•×¨×—×™× ×”×™×•×</div></div>
      <div class="stat"><div class="stn" id="sTotal">0</div><div class="stl">ğŸ“‹ ×¡×”"×› ×›× ×™×¡×•×ª</div></div>
      <div class="stat"><div class="stn" id="sTen">0</div><div class="stl">ğŸ  ×“×™×™×¨×™× ×¨×©×•××™×</div></div>
    </div>
    <div class="tabs">
      <div class="tab on" data-tab="reg">×¨×™×©×•× ××•×¨×—</div>
      <div class="tab" data-tab="list">×¨×©×™××ª ×›× ×™×¡×•×ª</div>
      <div class="tab" data-tab="tenants">×—×™×¤×•×© ×“×™×™×¨×™×</div>
    </div>

    <!-- ×¨×™×©×•× ××•×¨×— -->
    <div class="sec on" id="tab-reg">
      <div class="card">
        <div class="ch"><h3>×¨×™×©×•× ××•×¨×— ×—×“×©</h3></div>
        <div class="cb">
          <form id="gForm">
            <div class="grid2" style="margin-bottom:12px">
              <div class="fg"><label class="fl">×©× ××•×¨×— *</label><input type="text" id="gN" class="inp" required placeholder="×©× ×•×©× ××©×¤×—×”"></div>
              <div class="fg"><label class="fl">×§×˜×’×•×¨×™×” *</label>
                <select id="gCat" class="inp" required onchange="toggleOther(this,'gCatOther')"><option value="">×‘×—×¨...</option><option>××•×¨×— ×¤×¨×˜×™</option><option>×¡×¤×§/×˜×›× ××™</option><option>××©×œ×•×—</option><option>××—×¨</option></select>
              </div>
              <div class="fg" id="gCatOtherWrap" style="display:none;margin-top:-4px"><label class="fl">×¤×¨×˜ ××ª ×”×§×˜×’×•×¨×™×”</label><input type="text" id="gCatOther" class="inp" placeholder="×œ×“×•×’××”: ×§×‘×œ×Ÿ, ×¨×•×¤×..."></div>
            </div>

            <!-- ×—×™×¤×•×© ×“×™×™×¨ -->
            <div class="fg" style="margin-bottom:12px;position:relative">
              <label class="fl">×—×™×¤×•×© ×“×™×™×¨ ×××¨×— *</label>
              <div style="position:relative">
                <span style="position:absolute;right:11px;top:50%;transform:translateY(-50%);color:var(--t3);font-size:13px;pointer-events:none">ğŸ”</span>
                <input type="text" id="tenSearch" class="inp" placeholder="×”×§×œ×“ ×©× ×“×™×™×¨..." autocomplete="off" style="padding-right:32px" oninput="searchTenant(this.value)">
              </div>
              <div id="tenDropdown" style="display:none;position:absolute;top:100%;right:0;left:0;background:var(--d2);border:1px solid var(--gb);border-radius:var(--r2);z-index:100;max-height:200px;overflow-y:auto;box-shadow:0 8px 24px rgba(0,0,0,.5)"></div>
            </div>

            <!-- ×§×•××” ×•×“×™×¨×” (××•×œ××™× ××•×˜×•××˜×™×ª) -->
            <div class="grid2" style="margin-bottom:12px">
              <div class="fg"><label class="fl">×§×•××”</label><input type="text" id="gFlrDisp" class="inp" readonly placeholder="×™××•×œ× ××•×˜×•××˜×™×ª"></div>
              <div class="fg"><label class="fl">×“×™×¨×”</label><input type="text" id="gAptDisp" class="inp" readonly placeholder="×™××•×œ× ××•×˜×•××˜×™×ª"></div>
            </div>
            <input type="hidden" id="gFlr">
            <input type="hidden" id="gApt">
            <div class="fg" style="margin-bottom:12px"><label class="fl">×“×™×™×¨ ×××¨×—</label><input type="text" id="gTen" class="inp" readonly placeholder="×™××•×œ× ××•×˜×•××˜×™×ª"></div>
            <div class="fg" style="margin-bottom:12px">
              <label class="fl">× ×¨×©× ×¢×œ ×™×“×™ *</label>
              <select id="gEmployee" class="inp" required>
                <option value="">×‘×—×¨ ×¢×•×‘×“...</option>
                <option>××•×¨ ×¦×“×•×§</option>
                <option>××™×¦×™×§ ×§×¡×˜×•×¨×™×× ×•</option>
                <option>×‘× ×™××™×Ÿ ×’×•×¨××•</option>
                <option>×’'×• ×‘×™×˜×•×Ÿ</option>
                <option>×™×•×¡×£ ×××™×¨ ×¢××“×•</option>
                <option>×××™×¨ ×¡×‘×’</option>
                <option>××™×›××œ ××œ×§×™×Ÿ</option>
                <option>×¢×× ×•××œ ×œ×•×™</option>
                <option>×¢× ×ª ×›×”×Ÿ</option>
                <option>×©×œ×•××™×ª ×›×”×Ÿ</option>
              </select>
            </div>
            <div class="grid2" style="margin-bottom:16px">
              <div class="fg"><label class="fl">×ª××¨×™×š *</label><input type="date" id="gDt" class="inp" required></div>
              <div class="fg"><label class="fl">×©×¢×” *</label><input type="time" id="gTm" class="inp" required></div>
            </div>
            <button type="submit" class="sbtn" id="saveGuestBtn">âœ“ ×©××•×¨ ×¨×™×©×•×</button>
          </form>
        </div>
      </div>
    </div>

    <!-- ×¨×©×™××ª ×›× ×™×¡×•×ª -->
    <div class="sec" id="tab-list">
      <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px">
        <span style="font-family:'Playfair Display',serif;font-size:18px;font-weight:700">×¨×©×™××ª ×›× ×™×¡×•×ª</span>
        <button class="sbtn" id="exportBtn">ğŸ“¥ ×™×™×¦×•× Excel</button>
      </div>
      <div class="frow">
        <input type="date" id="fDate" class="fs">
        <select id="fCat" class="fs"><option value="">×›×œ ×”×§×˜×’×•×¨×™×•×ª</option><option>××•×¨×— ×¤×¨×˜×™</option><option>×¡×¤×§/×˜×›× ××™</option><option>××©×œ×•×—</option><option>××—×¨</option></select>
        <select id="fFlr" class="fs"><option value="">×›×œ ×”×§×•××•×ª</option><option value="3">×§×•××” 3</option>
<option value="4">×§×•××” 4</option>
<option value="5">×§×•××” 5</option>
<option value="6">×§×•××” 6</option>
<option value="7">×§×•××” 7</option>
<option value="8">×§×•××” 8</option>
<option value="9">×§×•××” 9</option>
<option value="10">×§×•××” 10</option>
<option value="11">×§×•××” 11</option>
<option value="12">×§×•××” 12</option>
<option value="13">×§×•××” 13</option>
<option value="14">×§×•××” 14</option>
<option value="15">×§×•××” 15</option>
<option value="16">×§×•××” 16</option>
<option value="17">×§×•××” 17</option>
<option value="18">×§×•××” 18</option>
<option value="19">×§×•××” 19</option>
<option value="20">×§×•××” 20</option>
<option value="21">×§×•××” 21</option>
<option value="22">×§×•××” 22</option>
<option value="23">×§×•××” 23</option>
<option value="24">×§×•××” 24</option>
<option value="25">×§×•××” 25</option>
<option value="26">×§×•××” 26</option>
<option value="27">×§×•××” 27</option>
<option value="28">×§×•××” 28</option>
<option value="29">×§×•××” 29</option>
<option value="30">×§×•××” 30</option>
<option value="31">×§×•××” 31</option>
<option value="32">×§×•××” 32</option>
<option value="33">×§×•××” 33</option>
<option value="34">×§×•××” 34</option>
<option value="35">×§×•××” 35</option>
<option value="36">×§×•××” 36</option>
<option value="37">×§×•××” 37</option>
<option value="38">×§×•××” 38</option>
<option value="39">×§×•××” 39</option>
<option value="40">×§×•××” 40</option>
<option value="41">×§×•××” 41</option>
<option value="42">×§×•××” 42</option></select>
      </div>
      <div class="card tw">
        <table><thead><tr><th>×©× ××•×¨×—</th><th>×§×˜×’×•×¨×™×”</th><th>×§×•××”</th><th>×“×™×¨×”</th><th>×“×™×™×¨ ×××¨×—</th><th>×ª××¨×™×š</th><th>×©×¢×”</th></tr></thead>
        <tbody id="gTbl"><tr><td colspan="7" class="ec">×˜×•×¢×Ÿ... <span class="spinner"></span></td></tr></tbody></table>
      </div>
    </div>

    <!-- ×—×™×¤×•×© ×“×™×™×¨×™× -->
    <div class="sec" id="tab-tenants">
      <div class="sbox">
        <div class="sbi"><span class="sbico">ğŸ”</span><input type="text" id="tSrch" class="sbinp" placeholder="×©×, ×˜×œ×¤×•×Ÿ, ×“×™×¨×”, ×§×•××”..."><button class="sbcl" onclick="clrT()">âœ•</button></div>
        <div class="sbtags">
          <span class="stag on" data-f="all">×”×›×œ</span><span class="stag" data-f="name">×©×</span><span class="stag" data-f="phone">×˜×œ×¤×•×Ÿ</span><span class="stag" data-f="apt">×“×™×¨×”</span><span class="stag" data-f="floor">×§×•××”</span>
        </div>
      </div>
      <div class="frow">
        <select id="tFlr" class="fs"><option value="">×›×œ ×”×§×•××•×ª</option><option value="3">×§×•××” 3</option>
<option value="4">×§×•××” 4</option>
<option value="5">×§×•××” 5</option>
<option value="6">×§×•××” 6</option>
<option value="7">×§×•××” 7</option>
<option value="8">×§×•××” 8</option>
<option value="9">×§×•××” 9</option>
<option value="10">×§×•××” 10</option>
<option value="11">×§×•××” 11</option>
<option value="12">×§×•××” 12</option>
<option value="13">×§×•××” 13</option>
<option value="14">×§×•××” 14</option>
<option value="15">×§×•××” 15</option>
<option value="16">×§×•××” 16</option>
<option value="17">×§×•××” 17</option>
<option value="18">×§×•××” 18</option>
<option value="19">×§×•××” 19</option>
<option value="20">×§×•××” 20</option>
<option value="21">×§×•××” 21</option>
<option value="22">×§×•××” 22</option>
<option value="23">×§×•××” 23</option>
<option value="24">×§×•××” 24</option>
<option value="25">×§×•××” 25</option>
<option value="26">×§×•××” 26</option>
<option value="27">×§×•××” 27</option>
<option value="28">×§×•××” 28</option>
<option value="29">×§×•××” 29</option>
<option value="30">×§×•××” 30</option>
<option value="31">×§×•××” 31</option>
<option value="32">×§×•××” 32</option>
<option value="33">×§×•××” 33</option>
<option value="34">×§×•××” 34</option>
<option value="35">×§×•××” 35</option>
<option value="36">×§×•××” 36</option>
<option value="37">×§×•××” 37</option>
<option value="38">×§×•××” 38</option>
<option value="39">×§×•××” 39</option>
<option value="40">×§×•××” 40</option>
<option value="41">×§×•××” 41</option>
<option value="42">×§×•××” 42</option></select>
        <select id="tSort" class="fs"><option value="floor">××™×•×Ÿ: ×§×•××”</option><option value="name">××™×•×Ÿ: ×©×</option><option value="apt">××™×•×Ÿ: ×“×™×¨×”</option></select>
        <span class="tcnt" id="tCnt"></span>
      </div>
      <div class="card tw"><table><thead><tr><th>×©× ××œ×</th><th>×§×•××”</th><th>×“×™×¨×”</th><th>×˜×œ×¤×•×Ÿ</th></tr></thead><tbody id="tTbl"></tbody></table></div>
    </div>
  </div>
</div>

<!-- MODAL EDIT -->
<div id="mEdit" style="position:fixed;inset:0;background:rgba(0,0,0,.8);display:none;align-items:center;justify-content:center;z-index:9999;padding:20px;backdrop-filter:blur(8px)">
  <div style="background:#111214;border:1px solid rgba(201,168,76,.28);border-radius:16px;width:100%;max-width:420px;box-shadow:0 8px 40px rgba(0,0,0,.6);position:relative">
    <div style="background:linear-gradient(to right,transparent,#c9a84c,transparent);height:1px;position:absolute;top:0;left:0;right:0"></div>
    <div style="padding:18px 20px 14px;border-bottom:1px solid #242629;display:flex;align-items:center;justify-content:space-between">
      <h3 style="font-family:'Playfair Display',serif;font-size:17px;font-weight:700">âœï¸ ×¢×¨×™×›×ª ××•×¨×—</h3>
      <button onclick="document.getElementById('mEdit').style.display='none'" style="width:28px;height:28px;background:#1c1e22;border:1px solid #2e3035;color:#a89878;border-radius:6px;cursor:pointer;font-size:13px">âœ•</button>
    </div>
    <form id="editForm">
      <input type="hidden" id="editId">
      <div style="padding:18px 20px;display:flex;flex-direction:column;gap:13px">
        <div class="grid2">
          <div class="fg"><label class="fl">×©× ××•×¨×— *</label><input type="text" id="editN" class="inp" required></div>
          <div class="fg"><label class="fl">×§×˜×’×•×¨×™×”</label><select id="editCat" class="inp"><option>××•×¨×— ×¤×¨×˜×™</option><option>×¡×¤×§/×˜×›× ××™</option><option>××©×œ×•×—</option><option>××—×¨</option></select></div>
        </div>
        <div class="fg"><label class="fl">× ×¨×©× ×¢×œ ×™×“×™</label>
          <select id="editEmployee" class="inp">
            <option value="">×‘×—×¨ ×¢×•×‘×“...</option>
            <option>××•×¨ ×¦×“×•×§</option>
            <option>××™×¦×™×§ ×§×¡×˜×•×¨×™×× ×•</option>
            <option>×‘× ×™××™×Ÿ ×’×•×¨××•</option>
            <option>×’'×• ×‘×™×˜×•×Ÿ</option>
            <option>×™×•×¡×£ ×××™×¨ ×¢××“×•</option>
            <option>×××™×¨ ×¡×‘×’</option>
            <option>××™×›××œ ××œ×§×™×Ÿ</option>
            <option>×¢×× ×•××œ ×œ×•×™</option>
            <option>×¢× ×ª ×›×”×Ÿ</option>
            <option>×©×œ×•××™×ª ×›×”×Ÿ</option>
          </select>
        </div>
        <div class="grid2">
          <div class="fg"><label class="fl">×ª××¨×™×š</label><input type="date" id="editDt" class="inp"></div>
          <div class="fg"><label class="fl">×©×¢×”</label><input type="time" id="editTm" class="inp"></div>
        </div>
      </div>
      <div style="padding:13px 20px;border-top:1px solid #242629;display:flex;justify-content:flex-end;gap:9px">
        <button type="button" onclick="document.getElementById('mEdit').style.display='none'" style="background:transparent;color:#a89878;border:1px solid #2e3035;padding:9px 20px;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;font-family:inherit">×‘×™×˜×•×œ</button>
        <button type="submit" class="sbtn" id="saveEditBtn">×©××•×¨ ×©×™× ×•×™×™×</button>
      </div>
    </form>
  </div>
</div>

<div class="toast" id="toastEl"></div>

<script type="module">

import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, onSnapshot, query, orderBy, setDoc, updateDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';

const firebaseConfig = {
  apiKey: "AIzaSyBfnYW-d4UFVvuqdxCLk_autpWmOLL2zFo",
  authDomain: "leonrdi-de-vinhi.firebaseapp.com",
  projectId: "leonrdi-de-vinhi",
  storageBucket: "leonrdi-de-vinhi.firebasestorage.app",
  messagingSenderId: "287853664744",
  appId: "1:287853664744:web:3812f47e80da3ef5e12c5d"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);


const TODAY = new Date().toISOString().split('T')[0];
let tFld = 'all';

function badge(cat){
  if(!cat) return '<span class="bdg bgy">â€”</span>';
  const m={'××•×¨×— ×¤×¨×˜×™':'bb','×¡×¤×§/×˜×›× ××™':'bg','××©×œ×•×—':'bgr'};
  const base = cat.startsWith('××—×¨') ? 'bgy' : (m[cat]||'bgy');
  return `<span class="bdg ${base}">${cat}</span>`;
}
function fd(d){if(!d)return'â€”';const p=d.split('-');return`${p[2]}/${p[1]}/${p[0]}`;}
function toast(msg,type){
  const e=document.getElementById('toastEl');
  e.textContent=msg;e.className=`toast ${type||''}`;e.classList.add('show');
  setTimeout(()=>e.classList.remove('show'),3200);
}
function hl(str,q){
  if(!q||!str)return str||'';
  return str.replace(new RegExp(`(${q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&')})`,'gi'),'<mark>$1</mark>');
}
function tick(){
  const n=new Date();
  const el=document.getElementById('clk');
  if(el) el.textContent=n.toLocaleDateString('he-IL',{weekday:'short',day:'numeric',month:'short'})+' | '+n.toLocaleTimeString('he-IL',{hour:'2-digit',minute:'2-digit',second:'2-digit'});
}
setInterval(tick,1000);tick();


// â”€â”€ TENANTS (local) â”€â”€
var tenants=[
  {id:'t1',name:'××œ×™×©×™ ×›×“×™×¨',phone:'052-8838381',floor:3,apt:'1'},
  {id:'t2',name:'××•×œ×™ ×¦×œ××œ',phone:'052-2314412',floor:4,apt:'6'},
  {id:'t3',name:'××™×” ×•×™×–×”×¨ ×§×™×™× ×¨',phone:'054-5629944',floor:5,apt:'11'},
  {id:'t4',name:'×™× ×™×‘ ×§×“×©××™',phone:'050-5251110',floor:6,apt:'16'},
  {id:'t5',name:'××‘×¨×”× ×¢×¨×”',phone:'0546915134',floor:7,apt:'21'},
  {id:'t6',name:'×‘×•×’×“×Ÿ ×§×•×¨×˜× ×•×‘',phone:'054-3497897',floor:8,apt:'26'},
  {id:'t7',name:'××‘×œ×™×Ÿ ×•×’×‘×¨×™××œ × ×’×¨',phone:'053-7726864',floor:8,apt:'27'},
  {id:'t8',name:'×¢××™×ª ×“×•×™×“×•×£',phone:'052-8949240',floor:8,apt:'28'},
  {id:'t9',name:'××™×™×œ ×¤×¨×¡×™××“×•',phone:'054-7713030',floor:8,apt:'29'},
  {id:'t10',name:'××•×¨×Ÿ ×§×•×§×• ×”×©×§×¢×•×ª',phone:'054-5420208',floor:9,apt:'30'},
  {id:'t11',name:'× ×•×¢×” ×•×ª×•× ×§×œ×™×¨ ×’×•×¨×‘×™×¥',phone:'054-4400005',floor:9,apt:'31'},
  {id:'t12',name:'×¢×•××¨ ××“×œ×¨',phone:'052-4627525',floor:9,apt:'32'},
  {id:'t13',name:'××©×” ×•×’×™×œ×” ××•×©×¨×ª',phone:'052-8662929',floor:9,apt:'33'},
  {id:'t14',name:'×¢×•××¨×™ ×›×”×Ÿ',phone:'050-3360000',floor:10,apt:'34'},
  {id:'t15',name:'×§×¨×Ÿ ×§×™×¨×©× ×¨',phone:'054-7799137',floor:10,apt:'35'},
  {id:'t16',name:'×’×™×œ ×•×™×¡××Ÿ ×¢×•××¨ ×”×•×œ×¦××Ÿ',phone:'054-7421444',floor:10,apt:'36'},
  {id:'t17',name:'××¤×¨×ª/×”×’×¨ ×§×“×',phone:'052-2854823',floor:10,apt:'37'},
  {id:'t18',name:'×˜×œ ×•××“× ×¤×œ×•×˜×§×™×Ÿ',phone:'052-3262000',floor:10,apt:'38'},
  {id:'t19',name:'××§×',phone:'',floor:10,apt:'39'},
  {id:'t20',name:'×—×’×™×ª ×‘×Ÿ ×˜×•×‘',phone:'052-4662828',floor:11,apt:'40'},
  {id:'t21',name:'×™× ×™×‘ ×™×•× ×”',phone:'054-4888579',floor:11,apt:'41'},
  {id:'t22',name:'×“×™×Ÿ ××¨×‘×•×‘ ×›×¨××œ ×‘×Ÿ ×“×•×“',phone:'054-3970713',floor:11,apt:'42'},
  {id:'t23',name:'×‘×¨ ×¦×•×¨× ×™',phone:'054-3080458',floor:11,apt:'43'},
  {id:'t24',name:'×ª×›×œ×ª ×•× ×•×¢× ×¤×•×¨×˜××Ÿ',phone:'0542203068',floor:11,apt:'44'},
  {id:'t25',name:'×™×¢×§×‘ ×•××•×¨×” ×‘×•×‘×¨×•×‘×¡×§×™ ×‘××¨',phone:'050-7292772',floor:11,apt:'45'},
  {id:'t26',name:'××¨×§×• ×§× ×¤×•',phone:'054-7498477',floor:12,apt:'46'},
  {id:'t27',name:'×“×Ÿ ×‘×¨× ×©×˜×™×™×Ÿ',phone:'052-8444499',floor:12,apt:'47'},
  {id:'t28',name:'×œ×™××•×¨ ×‘×¨×’××Ÿ',phone:'052-5008484',floor:12,apt:'48'},
  {id:'t29',name:'×¨×¤×™ ×•×¨×•×ª×™ ×©×§×œ',phone:'054-4264647',floor:12,apt:'49'},
  {id:'t30',name:'××‘× ×¨ ×•×™×¢×œ ×—×“×“',phone:'054-5211329',floor:12,apt:'50'},
  {id:'t31',name:'×˜×œ ×©×§×“',phone:'054-7741333',floor:12,apt:'51'},
  {id:'t32',name:'×™×”×•×“×™×ª ×•×©××•××œ ×¦×•×¨',phone:'052-4605048',floor:13,apt:'52'},
  {id:'t33',name:'×œ×™×œ×š ×•×™×§×™ ×‘×œ×“×‘',phone:'054-2282362',floor:13,apt:'53'},
  {id:'t34',name:'× ×•×¢× ×‘×•× ×•××•',phone:'052-4442432',floor:13,apt:'54'},
  {id:'t35',name:'××œ×•×“×™ ×•×‘×•×¢×– ×’×•×¨×Ÿ ×§×œ×™××™',phone:'050-2121540',floor:13,apt:'55'},
  {id:'t36',name:'××•×¨×Ÿ ×—×¡×•×Ÿ × ×•×¨×™×ª',phone:'054-9770111',floor:13,apt:'56'},
  {id:'t37',name:'××œ×•×Ÿ ×•×™× ×¨',phone:'052-8394983',floor:13,apt:'57'},
  {id:'t38',name:'××¨×™××œ ×¡××•×—×™',phone:'050-6828406',floor:14,apt:'59'},
  {id:'t39',name:'××•×¤×§ ×•×œ×™×¡×” ×›×ª×¨×™××œ',phone:'053-4300430',floor:14,apt:'60'},
  {id:'t40',name:'×™××™×¨ ××“×¨×ª',phone:'054-7299721',floor:14,apt:'61'},
  {id:'t41',name:'×™×¢×¨×” ×•×¡×¤×™ ×œ×¨× ×¨,×–×¨×¦×§×™',phone:'052-6769116',floor:14,apt:'62'},
  {id:'t42',name:'×¨×•× ×Ÿ ×™×•×“×§×‘×™×¥',phone:'052-3510518',floor:14,apt:'63'},
  {id:'t43',name:'×“× ×” ××©×›× ×–×™',phone:'054-4402240',floor:15,apt:'64'},
  {id:'t44',name:'×“× ×™ ×¡×œ×‘×™×Ÿ ×× ×’×œ×™× ×” ×§× ×–× ×™×§×•×‘×”',phone:'050-3020671',floor:15,apt:'65'},
  {id:'t45',name:'×ª×•× ×•×§×•×¨×œ × ×™×¡× ×™',phone:'050-9960409',floor:15,apt:'66'},
  {id:'t46',name:'× ×˜×¢ ×¦×“×•×§ ×™×•×¡×™ ×–×œ× ×¡×§×™',phone:'052-5361834',floor:15,apt:'67'},
  {id:'t47',name:'×¦×‘×™×” ×œ× ×™×¨',phone:'054-4891948',floor:15,apt:'68'},
  {id:'t48',name:'××¨×× ×“ ×•×ª××¨×” ××•×’\'×¨×“',phone:'052-8700883',floor:15,apt:'69'},
  {id:'t49',name:'××™×¨×‘ ×•×©×œ×•× (× ×™×¡×™×) ××œ×•×œ ×‘×™×˜×Ÿ',phone:'053-3333830',floor:16,apt:'70'},
  {id:'t50',name:'×¢× ×‘×œ ××¨×‘×•×‘',phone:'054-4803696',floor:16,apt:'71'},
  {id:'t51',name:'×©×œ×™ ×‘×Ÿ ×™×•×¡×£ ×“×•×¨ × ×¦×¨',phone:'054-3974224',floor:16,apt:'72'},
  {id:'t52',name:'×™×•× ×ª×Ÿ ×•× ××•×” ××’×‘×¨',phone:'050-6350170',floor:16,apt:'73'},
  {id:'t53',name:'××œ×›×¡× ×“×¨ ×•×™×¢×œ × ×ª×Ÿ ×•×™× ×§×œ×¨',phone:'847-6079376',floor:16,apt:'74'},
  {id:'t54',name:'××‘×™ ×•××™×¨×‘  ×œ×•×™ ×™×œ×“×™×: ×©×™×¨,×™×•×‘×œ,×××™×” ,×¢××™×ª',phone:'050-5386415',floor:16,apt:'75'},
  {id:'t55',name:'×’××Ÿ ×‘×¨×‘×™',phone:'',floor:17,apt:'76'},
  {id:'t56',name:'×™×•×‘×œ ×¦×“×•×§',phone:'050-7279792',floor:17,apt:'77'},
  {id:'t57',name:'××•×˜×™  ×•×ª×™××•×¨×” ×©×™×¨×™',phone:'050-5708462',floor:17,apt:'78'},
  {id:'t58',name:'×˜×•×‘×™ ×•×˜×¨×” ×¨×™×“×œ×•×•×™×¥,×©×•× ×’×•×˜',phone:'058-4887898',floor:17,apt:'79'},
  {id:'t59',name:'×”×™×œ×“×” ×¨×’×•××Ÿ',phone:'052-2579051',floor:17,apt:'80'},
  {id:'t60',name:'×¨×•×ª×™ ×¨×–',phone:'050-6255995',floor:17,apt:'81'},
  {id:'t61',name:'×œ×™×“×•×¨ ×•×¢××™×ª ××–×•×œ××™ , ×’×–×™×ª',phone:'054-2563396',floor:18,apt:'82'},
  {id:'t62',name:'××™×›××œ ×¤×œ×“',phone:'050-8221770',floor:18,apt:'83'},
  {id:'t63',name:'××¡× ×ª ××‘×™×‘×™',phone:'054-4290380',floor:18,apt:'84'},
  {id:'t64',name:'×‘× ×“×˜×” ×•×˜×œ ×§×¨×¡×•',phone:'050-5770404',floor:18,apt:'85'},
  {id:'t65',name:'× ×¢×” ×•××™×ª××¨ ×¤×œ×§×•×Ÿ',phone:'052-8041115',floor:18,apt:'86'},
  {id:'t66',name:'×•×¨×“ ×¢×‘×¨×™',phone:'052-3256318',floor:18,apt:'87'},
  {id:'t67',name:'××‘×¨×”× ×•×œ×“×–×™',phone:'054-4776360',floor:19,apt:'89'},
  {id:'t68',name:'×“×•×“ ××¥',phone:'054-5565066',floor:19,apt:'90'},
  {id:'t69',name:'××•×“×™ ×¤××™× ×™',phone:'052-2631978',floor:19,apt:'91'},
  {id:'t70',name:'×™××™×¨ ×¡×œ×•×¦×™× ×¡×§×™',phone:'050-5337880',floor:19,apt:'92'},
  {id:'t71',name:'×¤×™×œ×™×¤ ×¤×™× ×—×¡ ×•×¡× ×“×¨×” ×œ×–×•×‘×™×§',phone:'052-3404295',floor:19,apt:'93'},
  {id:'t72',name:'×¢×“×™ ×œ×•×™ ××œ×•×Ÿ ××›×”×Ÿ',phone:'054-5333996',floor:20,apt:'94'},
  {id:'t73',name:'×œ×™ ×—× ×•× ×•',phone:'054-2129277',floor:20,apt:'95'},
  {id:'t74',name:'×“× ×” ×•×©××•××œ ××‘×Ÿ',phone:'054-3977847',floor:20,apt:'96'},
  {id:'t75',name:'×“×•×¨×•×Ÿ ××œ×›×¡× ×“×¨',phone:'054-4452878',floor:20,apt:'97'},
  {id:'t76',name:'×ª×§×•×” ×•××™×¦×™×§ ×©×§×“',phone:'050-2724581',floor:20,apt:'98'},
  {id:'t77',name:'×™×•×¡×™ ×•×™×¢×œ ×›×”×Ÿ',phone:'053-5575817',floor:20,apt:'99'},
  {id:'t78',name:'× ×™×‘ ×•××–× ×”',phone:'054-2345159',floor:21,apt:'100'},
  {id:'t79',name:'×™×•×‘×œ ×¡× ×” ×™×•×‘×œ  ×¨×™× ×¨',phone:'052-4231509',floor:21,apt:'101'},
  {id:'t80',name:'×“×™×Ÿ ×œ×™×›×˜× ×©×˜×™×™×Ÿ',phone:'+14168717173',floor:21,apt:'102'},
  {id:'t81',name:'× ×•×¢× ×“×•×ª×Ÿ ×¢×“×Ÿ ×× ×§×¨×™',phone:'054-4983482',floor:21,apt:'103'},
  {id:'t82',name:'×ª××™ ×¤×¨×™×“×œ',phone:'050-6814023',floor:21,apt:'104'},
  {id:'t83',name:'×’×™× ×›×¡×¤×¨×™',phone:'054-2009579',floor:21,apt:'105'},
  {id:'t84',name:'×ª×•××¨ ×‘×œ×“×‘',phone:'054-5707234',floor:22,apt:'106'},
  {id:'t85',name:'×¢×•×“×“ ×§×™× ×Ÿ',phone:'054-5836199',floor:22,apt:'107'},
  {id:'t86',name:'××¨×™×§, ×™×¢×œ ×¤×•×¨×ª',phone:'052-2565767',floor:22,apt:'108'},
  {id:'t87',name:'×¢× ×ª ×©×˜×¨×™×ª',phone:'054-5883066',floor:22,apt:'109'},
  {id:'t88',name:'× ×™×‘',phone:'052-3308287',floor:22,apt:'110'},
  {id:'t89',name:'××©×” ×•×©×œ×•××™×ª ×œ×“×•×¨',phone:'050-6216696',floor:22,apt:'111'},
  {id:'t90',name:'×××™×” ××•×¤×§',phone:'050-8255314',floor:23,apt:'112'},
  {id:'t91',name:'××•×¡× ×ª ×•×©×œ××” ×¡×‘××’',phone:'054-5883393',floor:23,apt:'113'},
  {id:'t92',name:'××”×•×‘×” ×•××‘×™ ×™×”×œ',phone:'050-9772222',floor:23,apt:'114'},
  {id:'t93',name:'×¢×•××¨×™ ×•×œ×™××•×¨ / ×™×¤×ª×— ×¨×•×ª ×œ×•×¨×š',phone:'052-2502636',floor:23,apt:'115'},
  {id:'t94',name:'××œ×™ ×•×¨×—×œ ×× ×’×œ',phone:'050-6560026',floor:23,apt:'116'},
  {id:'t95',name:'×“× ×™××œ ×•×¨×•×¢×™ ×× ×’\'×œ',phone:'054-7808014',floor:23,apt:'117'},
  {id:'t96',name:'××™×œ×Ÿ ×˜×•×‘×™×”×•',phone:'054-5335555',floor:24,apt:'118'},
  {id:'t97',name:'×¢× ×‘×œ ××¨×‘×•×‘',phone:'054-4803696',floor:24,apt:'119'},
  {id:'t98',name:'××ª×Ÿ ×ª×•×¨×’××Ÿ ×“× ×” ×©×œ×•×',phone:'054-8836588',floor:24,apt:'120'},
  {id:'t99',name:'×¤×œ×•×¨×™ ×•×¡×˜×™×‘ ×’×•×œ×“×©×˜×™×™×Ÿ',phone:'052-8783646',floor:24,apt:'121'},
  {id:'t100',name:'×¢×•×“×“ ×©×™×œ×•×Ÿ ××™×” ××‘× ×™',phone:'054-7600070',floor:24,apt:'122'},
  {id:'t101',name:'×©×¨×œ×•×˜ ×•×™×¢×§×‘ ×¤×•×œ× ×™',phone:'+447825274499',floor:24,apt:'123'},
  {id:'t102',name:'××™×¨×™×ª ×•×™×•×¡×£ ×‘×™×‘×¨',phone:'050-6574421',floor:25,apt:'124'},
  {id:'t103',name:'×”×“×¡ ×œ×•×™×˜ ×™×©×¨××œ×™',phone:'052-4717020',floor:25,apt:'125'},
  {id:'t104',name:'×œ×• ×•×™×•××Ÿ',phone:'+590-690664316',floor:25,apt:'126'},
  {id:'t105',name:'××¨×§ ×œ×™×‘×¨××Ÿ',phone:'054-6778150',floor:25,apt:'127'},
  {id:'t106',name:'×™××™×¨ ×‘×¨×¡',phone:'052-2225943',floor:25,apt:'128'},
  {id:'t107',name:'××•×¨×™ ××•×¡×§×•× ×”',phone:'054-4690020',floor:25,apt:'129'},
  {id:'t108',name:'×©×¨×•×Ÿ ××™×‘×’×™',phone:'052-3683005',floor:26,apt:'130'},
  {id:'t109',name:'×¢× ×‘×œ ××¨×‘×•×‘',phone:'054-4803696',floor:26,apt:'131'},
  {id:'t110',name:'××œ×™ ×“×•×‘× ×•×‘',phone:'052-5552588',floor:26,apt:'132'},
  {id:'t111',name:'×¢× ×ª ××˜×•×Ÿ',phone:'052-2681327',floor:26,apt:'133'},
  {id:'t112',name:'×©×™ ×’×¨×™× ×‘×¨×’',phone:'052-6303660',floor:26,apt:'134'},
  {id:'t113',name:'××“×•×” ×•××¡×£ ×©×•××¨×•×Ÿ',phone:'052-4846860',floor:26,apt:'135'},
  {id:'t114',name:'×××™×¨ ×“×¤×¡',phone:'052-3895808',floor:27,apt:'136'},
  {id:'t115',name:'×’×“ ×©××¨×•×Ÿ',phone:'052-3112330',floor:27,apt:'137'},
  {id:'t116',name:'×’×•×œ×Ÿ ×–×¨×‘×™×‘',phone:'050-9400629',floor:27,apt:'138'},
  {id:'t117',name:'×’× ×™×” ×•×™×•×¡×£ ×§×•×¡×˜',phone:'054-4690916',floor:27,apt:'139'},
  {id:'t118',name:'×“×™× ×” ×•×™×¢×§×‘ ×˜×¨×•×‘×¦×§×™',phone:'054-4243355',floor:27,apt:'140'},
  {id:'t119',name:'××•×¨×™ ×•×˜×œ×™ ××¨×–×™',phone:'054-7884242',floor:27,apt:'141'},
  {id:'t120',name:'××¨×– ×¨×•×—××”',phone:'053-7755398',floor:28,apt:'142'},
  {id:'t121',name:'×××•×¨ ××‘×™×˜×œ',phone:'052-2840568',floor:28,apt:'143'},
  {id:'t122',name:'×¦×— ×•×œ×™× ×•×¨ ×¢×•×‘×“',phone:'054-4827876',floor:28,apt:'144'},
  {id:'t123',name:'×¨×—×œ ×ª×•×¨×Ÿ',phone:'052-2581454',floor:28,apt:'145'},
  {id:'t124',name:'×¢×¨×Ÿ ×‘×¨× ×¢',phone:'050-5299930',floor:28,apt:'146'},
  {id:'t125',name:'×™×•×¢×“ ×•×¡×œ×‘×™×” ××§×•×‘',phone:'052-4676067',floor:28,apt:'147'},
  {id:'t126',name:'××‘×™×§×',phone:'052-6063019',floor:29,apt:'148'},
  {id:'t127',name:'×™×•××‘ ×§×¨×™×œ',phone:'054-4331338',floor:29,apt:'149'},
  {id:'t128',name:'× ×ª×™ ×•×™×¢×§×‘ ×œ×•×™',phone:'050-6770279',floor:29,apt:'151'},
  {id:'t129',name:'××©×” ×‘×•×§×¨×™×¡ ×™×•×œ× ×“×” ×•×™×¦××Ÿ',phone:'052-8690095',floor:29,apt:'152'},
  {id:'t130',name:'×¨×•×¢×™ ×›×”×Ÿ ××Ÿ ××¨×™ × ×•×‘×§',phone:'050-2966486',floor:29,apt:'153'},
  {id:'t131',name:'×¨×•××Ÿ ×¤×¨×©×˜×¨',phone:'+1-6174777765',floor:30,apt:'155'},
  {id:'t132',name:'×™×•×ª× ×›×”×Ÿ',phone:'054-3176196',floor:30,apt:'156'},
  {id:'t133',name:'×™××™×¨ ××“×™×œ× ×“',phone:'054-4224333',floor:30,apt:'157'},
  {id:'t134',name:'×××™×¨ ×•××“×¨×™×× ×” ××’××™',phone:'04-6276644',floor:30,apt:'158'},
  {id:'t135',name:'×œ×™××‘ ××›×™×–×¨',phone:'054-4332099',floor:31,apt:'160'},
  {id:'t136',name:'××ª×Ÿ ×¡×•×•×™×¡×”',phone:'052-3127726',floor:31,apt:'161'},
  {id:'t137',name:'×œ××” ×•×¡××•××œ ×›×”×Ÿ',phone:'054-2530705',floor:31,apt:'162'},
  {id:'t138',name:'×œ×™×“×•×¨ ×¤×œ×“××Ÿ ×¨×•×¢×™ ×’×•× ×Ÿ',phone:'052-8671515',floor:31,apt:'163'},
  {id:'t139',name:'×™×¨×•×Ÿ ×’×œ×‘×•×¢',phone:'052-5775786',floor:31,apt:'164'},
  {id:'t140',name:'×˜×œ×™,×™×•××‘,××•×¨×™,×™××™×¨ ×•×¨×©×‘×¡×§×™',phone:'052-8752521',floor:31,apt:'165'},
  {id:'t141',name:'×¢×•××¨ ×•× ×™×¡×™×/××©×” ×“××¨×™',phone:'050-6967801',floor:32,apt:'166'},
  {id:'t142',name:'×¢××™×ª ×‘× ×–×¨×£ ×œ×™×œ×™ ×‘×•×¨×§×•×‘×¡×§×™',phone:'054-3032229',floor:32,apt:'167'},
  {id:'t143',name:'× ×™×§×™ ×¤×¨×™××•',phone:'052-2313313',floor:32,apt:'168'},
  {id:'t144',name:'×™× ×™×¨ ×•××•×œ×’×” ×§××—×™',phone:'054-6969938',floor:32,apt:'169'},
  {id:'t145',name:'×©×œ××” ×•×™×¨×•× ×”, ×’×™×œ ×‘×Ÿ ×“×•×“',phone:'054-6550560',floor:32,apt:'170'},
  {id:'t146',name:'×©×œ××” ×•×™×¨×•× ×”, ×’×™×œ ×‘×Ÿ ×“×•×“',phone:'050-2323891',floor:32,apt:'171'},
  {id:'t147',name:'×’×™×œ ×•×™× ×¨',phone:'054-9993700',floor:33,apt:'172'},
  {id:'t148',name:'×™×¢×œ ×‘×¨×§ ××¨×™××œ ×‘×•×¨×•×¦× ×¨',phone:'050-3340591',floor:33,apt:'173'},
  {id:'t149',name:'××•×¨×™ ×××•×™××œ ×©×¨×•×Ÿ ×–×œ×¦××Ÿ',phone:'053-5283889',floor:33,apt:'174'},
  {id:'t150',name:'×¢× ×ª ×•×¢×•×–×™ ×©×¨×™×“',phone:'050-6204681',floor:33,apt:'175'},
  {id:'t151',name:'× ×™×¨×™×ª ×©××¢×•× ×™',phone:'050-5390344',floor:33,apt:'176'},
  {id:'t152',name:'×™×¤×” ×•×××™×¨ ×›×¨×',phone:'052-4015550',floor:33,apt:'177'},
  {id:'t153',name:'× ×•×¢× ×¤×¨×“×§×™×Ÿ',phone:'054-4264946',floor:34,apt:'178'},
  {id:'t154',name:'× ××•×” ×•×¢×–×™ ×˜×¨×™×¦×¨',phone:'052-3997299',floor:34,apt:'179'},
  {id:'t155',name:'×¨×•×ª ×•××œ×“×“ ××œ×•×Ÿ',phone:'054-7657507',floor:34,apt:'180'},
  {id:'t156',name:'×’×™× ×•×™×¤×¢×ª ××’××™',phone:'050-9898011',floor:34,apt:'181'},
  {id:'t157',name:'×˜×œ ××¨×•× ×™×•× ×™ ×©×˜×™×™×Ÿ',phone:'050-6791202',floor:35,apt:'182'},
  {id:'t158',name:'×¤× ×™× ×” ×•×¨×¤×™ ×©×•××¨×•×Ÿ',phone:'050-6288893',floor:35,apt:'183'},
  {id:'t159',name:'××œ×›×¡ ×•××‘×™×‘×” ×’×•×¨',phone:'054-6303004',floor:35,apt:'184'},
  {id:'t160',name:'×“×§×œ×” ×•×’×œ ×˜×•×˜×™××Ÿ ×–×™×™×“',phone:'052-8349349',floor:35,apt:'185'},
  {id:'t161',name:'××•×¨×™ ×©×•×•×¨×¥',phone:'052-6676863',floor:36,apt:'186'},
  {id:'t162',name:'××œ×›×¡ ×’×™× ×–×‘×•×¨×’',phone:'052-2331410',floor:36,apt:'187'},
  {id:'t163',name:'×™×¢×§×‘ ×‘×œ××˜',phone:'050-323-0963',floor:36,apt:'188'},
  {id:'t164',name:'× ×™×œ×™ ×–×•×”×¨ ××¨× ×•×Ÿ ×¨×•×œ× ×™×§',phone:'054-4267474',floor:36,apt:'189'},
  {id:'t165',name:'×¦×•×¨×™××œ ×œ×•×™×Ÿ',phone:'054-2463033',floor:37,apt:'190'},
  {id:'t166',name:'××•×¨×œ×™ ×•×™×¢×§×‘ ×‘×¨×¡',phone:'052-2213075',floor:37,apt:'191'},
  {id:'t167',name:'×¦×™×¤×™ ×•××¨×•×Ÿ ××Ÿ',phone:'054-8855080',floor:37,apt:'192'},
  {id:'t168',name:'×™×¢×œ ×©× ×™×“××Ÿ ××‘×™ ×™×¨×•×Ÿ',phone:'052-5798971',floor:37,apt:'193'},
  {id:'t169',name:'×”×“×¡ ××™×©××œ',phone:'054-4210494',floor:38,apt:'194'},
  {id:'t170',name:'×“×™×“×™ ×•×¤×œ×•×¨×™ ××¡×™×œ×ª×™',phone:'053-7250770',floor:38,apt:'195'},
  {id:'t171',name:'×“×™××˜×¨×™×¡ ××•×˜×™×˜×¡',phone:'054-3532255',floor:38,apt:'196'},
  {id:'t172',name:'×¢×•×¤×¨ ×”×“×¡ ××”×¨×©×§',phone:'054-4850289',floor:38,apt:'197'},
  {id:'t173',name:'×§×•×‘×™ ×¡×§××œ',phone:'050-5292629',floor:39,apt:'198'},
  {id:'t174',name:'×“×™×Ÿ ××¨×‘×•×‘ ×›×¨××œ ×‘×Ÿ ×“×•×“',phone:'054-3970713',floor:39,apt:'199'},
  {id:'t175',name:'××œ×” ×•××”×¨×•×Ÿ ×œ×•×™',phone:'054-4333023',floor:39,apt:'200'},
  {id:'t176',name:'××™×œ× ×” ×•×“×•×¨×•×Ÿ ×¤×œ×“',phone:'052-2754124',floor:39,apt:'201'},
  {id:'t177',name:'××™×¨×‘ ×•×©×œ××” ×¨×•×“×‘',phone:'054-9007000',floor:40,apt:'202'},
  {id:'t178',name:'××•×”×“ ×•××‘×™×’×™×œ ×‘×˜×¦×™×™×’',phone:'052-7777753',floor:40,apt:'203'},
  {id:'t179',name:'×›×¨××™ ×•×¢×¨×Ÿ ×–×™×¡××¤×œ',phone:'054-7693263',floor:41,apt:'204'},
  {id:'t180',name:'××™×ª×™ ×•×œ×™×”×™ ××™×œ×¨×“',phone:'054-4443520',floor:41,apt:'205'},
  {id:'t181',name:'××™×ª×™ ×•×œ×™×”×™ ××™×œ×¨×“',phone:'054-4443520',floor:42,apt:'206'},
];

function toggleOther(sel, inputId){
  const wrap = document.getElementById(inputId+'Wrap');
  if(sel.value==='××—×¨'){wrap.style.display='block';}
  else{wrap.style.display='none';document.getElementById(inputId).value='';}
}
window.toggleOther=toggleOther;
initApp();


// â”€â”€ INIT â”€â”€
function initApp(){
  const n=new Date();
  document.getElementById('gDt').value=TODAY;
  document.getElementById('gTm').value=n.toTimeString().slice(0,5);
  document.getElementById('sTen').textContent=tenants.length;
  autoCleanOldGuests();
  checkLobbyStatus();
  loadGuests();
  loadEmployeesLobby();
  renderTenants();
}

async function loadEmployeesLobby(){
  try{
    const snap = await getDocs(collection(db,'settings'));
    const s = snap.docs.find(d=>d.id==='employees');
    if(s && s.data().list){
      const opts = '<option value="">×‘×—×¨ ×¢×•×‘×“...</option>'+s.data().list.map(e=>`<option>${e}</option>`).join('');
      document.getElementById('gEmployee').innerHTML = opts;
    }
  }catch(e){ console.log('×©×’×™××” ×‘×˜×¢×™× ×ª ×¢×•×‘×“×™×:',e.message); }
}

// ×‘×“×™×§×ª ×¡×˜×˜×•×¡ ×œ×•×‘×™
async function checkLobbyStatus(){
  try{
    const snap = await getDocs(collection(db,'settings'));
    const s = snap.docs.find(d=>d.id==='lobby');
    // ×× ××™×Ÿ ×¨×©×•××” â€” ×¤×ª×•×— ×›×‘×¨×™×¨×ª ××—×“×œ
    const isOpen = s ? s.data().open !== false : true;
    if(!isOpen){
      document.getElementById('app').innerHTML = `
        <div style="position:fixed;inset:0;background:#09090b;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:16px;text-align:center;padding:20px">
          <div style="font-size:60px">ğŸ”´</div>
          <div style="font-family:'Playfair Display',serif;font-size:28px;font-weight:700;color:#c9a84c">×“×” ×•×™× ×¦'×™</div>
          <div style="font-size:18px;font-weight:700;color:#f0ead8">×”××¢×¨×›×ª ××™× ×” ×¤×¢×™×œ×” ×›×¨×’×¢</div>
          <div style="font-size:14px;color:#a89878;max-width:300px;line-height:1.6">×”×œ×•×‘×™ × ×¡×’×¨ ×¢×œ ×™×“×™ ×”×× ×”×œ.<br>×¤× ×” ×œ×× ×”×œ ×œ×¤×ª×™×—×ª ×”××¢×¨×›×ª.</div>
          <button onclick="location.reload()" style="background:#1c1e22;border:1px solid #242629;color:#a89878;padding:10px 24px;border-radius:8px;font-size:13px;cursor:pointer;font-family:'Heebo',sans-serif;margin-top:10px">ğŸ”„ ×‘×“×•×§ ×©×•×‘</button>
        </div>`;
    }
  }catch(e){
    // ×‘×©×’×™××” â€” ××œ ×ª×¡×’×•×¨, ×”×©××¨ ×¤×ª×•×—
    console.log('×©×’×™××” ×‘×‘×“×™×§×ª ×¡×˜×˜×•×¡:',e.message);
  }
}

// ××—×™×§×” ××•×˜×•××˜×™×ª + ×’×™×‘×•×™ ×œ××¨×›×™×•×Ÿ
async function autoCleanOldGuests(){
  try{
    const snap = await getDocs(collection(db,'guests'));
    const toDelete = snap.docs.filter(d => {
      const date = d.data().date;
      return date && date < TODAY;
    });
    if(!toDelete.length) return;

    // ×§×‘×¥ ×œ×¤×™ ×ª××¨×™×š ×•×©××•×¨ ×œ××¨×›×™×•×Ÿ
    const byDate = {};
    toDelete.forEach(d => {
      const data = d.data();
      const date = data.date;
      if(!byDate[date]) byDate[date] = [];
      byDate[date].push({id:d.id, ...data});
    });

    for(const [date, entries] of Object.entries(byDate)){
      await setDoc(doc(db,'archive',date), {
        date,
        entries,
        savedAt: new Date().toISOString(),
        count: entries.length
      });
    }

    // ××—×§ ×-guests
    for(const d of toDelete){ await deleteDoc(doc(db,'guests',d.id)); }
    console.log(`×’×•×‘×• ×•× ××—×§×• ${toDelete.length} ×›× ×™×¡×•×ª`);
  }catch(e){ console.log('×©×’×™××” ×‘× ×™×§×•×™:',e.message); }
}

// â”€â”€ GUESTS REALTIME â”€â”€
let guests=[];
function loadGuests(){
  const q=query(collection(db,'guests'),orderBy('createdAt','desc'));
  onSnapshot(q,snap=>{
    guests=snap.docs.map(d=>{{return{id:d.id,...d.data()}}});
    renderStats();
    renderGuestsList();
  });
}

function renderStats(){
  document.getElementById('sTen').textContent=tenants.length;
  document.getElementById('sTotal').textContent=guests.length;
  document.getElementById('sToday').textContent=guests.filter(g=>g.date===TODAY).length;
}

// FORM
// â”€â”€ ×—×™×¤×•×© ×“×™×™×¨ â”€â”€
let selectedTenant = null;

window.searchTenant = function(q){
  const dd = document.getElementById('tenDropdown');
  if(!q || q.length < 1){ dd.style.display='none'; return; }
  const s = q.trim().toLowerCase();
  const results = tenants.filter(t =>
    t.name.toLowerCase().includes(s) ||
    String(t.apt).includes(s) ||
    String(t.floor).includes(s) ||
    (t.phone && t.phone.replace(/-/g,'').includes(s.replace(/-/g,'')))
  ).slice(0,8);

  if(!results.length){
    dd.innerHTML='<div style="padding:12px;text-align:center;color:var(--t3);font-size:13px">×œ× × ××¦× ×“×™×™×¨</div>';
  } else {
    dd.innerHTML = results.map(t=>`
      <div onclick="selectTenant('${t.id}')" style="padding:10px 14px;cursor:pointer;border-bottom:1px solid var(--d4);transition:background .12s" onmouseover="this.style.background='var(--d3)'" onmouseout="this.style.background=''">
        <div style="font-weight:700;font-size:13px;color:var(--tx)">${t.name}</div>
        <div style="font-size:11px;color:var(--t3);margin-top:2px">×§×•××” ${t.floor} â€¢ ×“×™×¨×” ${t.apt}${t.phone?' â€¢ '+t.phone:''}</div>
      </div>`).join('');
  }
  dd.style.display='block';
};

window.selectTenant = function(id){
  const t = tenants.find(x=>x.id===id);
  if(!t) return;
  selectedTenant = t;
  document.getElementById('tenSearch').value = t.name;
  document.getElementById('gFlr').value = t.floor;
  document.getElementById('gApt').value = t.id;
  document.getElementById('gFlrDisp').value = '×§×•××” '+t.floor;
  document.getElementById('gAptDisp').value = '×“×™×¨×” '+t.apt;
  document.getElementById('gTen').value = t.name;
  document.getElementById('tenDropdown').style.display='none';
};

// ×¡×’×•×¨ dropdown ×‘×œ×—×™×¦×” ××—×•×¥
document.addEventListener('click', e=>{
  if(!e.target.closest('#tenSearch') && !e.target.closest('#tenDropdown')){
    document.getElementById('tenDropdown').style.display='none';
  }
});

document.getElementById('gForm').onsubmit=async function(e){
  e.preventDefault();
  const aid=document.getElementById('gApt').value;
  const t=tenants.find(x=>x.id===aid);
  if(!t){toast('×™×© ×œ×‘×—×•×¨ ×“×™×™×¨ ××”×¨×©×™××”','er');return;}
  const employee=document.getElementById('gEmployee').value;
  if(!employee){toast('×™×© ×œ×‘×—×•×¨ ×¢×•×‘×“','er');return;}
  const btn=document.getElementById('saveGuestBtn');
  btn.disabled=true;btn.textContent='×©×•××¨...';
  try{
    const catVal = document.getElementById('gCat').value;
    const catOther = document.getElementById('gCatOther').value.trim();
    const finalCat = catVal==='××—×¨' && catOther ? '××—×¨: '+catOther : catVal;
    await addDoc(collection(db,'guests'),{
      name:document.getElementById('gN').value.trim(),
      cat:finalCat,
      floor:parseInt(document.getElementById('gFlr').value),
      apt:t.apt,tid:aid,tname:t.name,
      date:document.getElementById('gDt').value,
      time:document.getElementById('gTm').value,
      createdAt:serverTimestamp(),
      registeredBy:employee
    });
    this.reset();
    selectedTenant = null;
    document.getElementById('tenSearch').value='';
    document.getElementById('gFlr').value='';
    document.getElementById('gApt').value='';
    document.getElementById('gFlrDisp').value='';
    document.getElementById('gAptDisp').value='';
    document.getElementById('gTen').value='';
    document.getElementById('gEmployee').value='';
    document.getElementById('gCatOtherWrap').style.display='none';
    const n=new Date();
    document.getElementById('gDt').value=TODAY;
    document.getElementById('gTm').value=n.toTimeString().slice(0,5);
    toast('××•×¨×— × ×¨×©× ×‘×”×¦×œ×—×” âœ“','ok');
  }catch(err){
    toast('×©×’×™××” ×‘×©××™×¨×”: '+err.message,'er');
  }
  btn.disabled=false;btn.textContent='âœ“ ×©××•×¨ ×¨×™×©×•×';
};

// GUESTS LIST
function renderGuestsList(){
  const d=document.getElementById('fDate').value;
  const c=document.getElementById('fCat').value;
  const f=document.getElementById('fFlr').value;
  const arr=guests.filter(g=>(!d||g.date===d)&&(!c||g.cat===c)&&(!f||String(g.floor)===f));
  document.getElementById('gTbl').innerHTML=arr.length
    ?arr.map(g=>`<tr><td><strong>${g.name}</strong></td><td>${badge(g.cat)}</td><td>×§×•××” ${g.floor}</td><td>${g.apt}</td><td>${g.tname}</td><td>${fd(g.date)}</td><td>${g.time}</td><td style="display:flex;gap:4px"><button class="ic" onclick="openEdit('${g.id}')">âœï¸</button><button class="ic dl" onclick="delGuest('${g.id}')">ğŸ—‘</button></td></tr>`).join('')
    :'<tr><td colspan="8" class="ec">××™×Ÿ ×›× ×™×¡×•×ª</td></tr>';
}
['fDate','fCat','fFlr'].forEach(id=>{
  document.getElementById(id).addEventListener('change',renderGuestsList);
});

// ×™×™×¦×•× Excel
document.getElementById('exportBtn').addEventListener('click',function(){
  if(!guests.length){toast('××™×Ÿ ×›× ×™×¡×•×ª ×œ×™×™×¦×•×','er');return;}
  const rows=guests.map(g=>({'×©× ××•×¨×—':g.name,'×§×˜×’×•×¨×™×”':g.cat,'×§×•××”':g.floor,'×“×™×¨×”':g.apt,'×“×™×™×¨ ×××¨×—':g.tname,'×ª××¨×™×š':fd(g.date),'×©×¢×”':g.time}));
  const ws=XLSX.utils.json_to_sheet(rows);
  const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,ws,'×›× ×™×¡×•×ª');
  XLSX.writeFile(wb,'×›× ×™×¡×•×ª_'+TODAY+'.xlsx');
  toast('×™×•×¦××• '+rows.length+' ×¨×©×•××•×ª âœ“','ok');
});

// DELETE + EDIT GUEST
window.delGuest=async function(id){
  if(!confirm('×œ××—×•×§?'))return;
  try{await deleteDoc(doc(db,'guests',id));toast('× ××—×§','ok');}
  catch(e){toast('×©×’×™××”: '+e.message,'er');}
};
window.openEdit=function(id){
  const g=guests.find(x=>x.id===id);
  if(!g)return;
  document.getElementById('editId').value=id;
  document.getElementById('editN').value=g.name;
  document.getElementById('editCat').value=g.cat;
  document.getElementById('editDt').value=g.date;
  document.getElementById('editTm').value=g.time;
  document.getElementById('editEmployee').value=g.registeredBy||'';
  document.getElementById('mEdit').style.display='flex';
};
document.getElementById('mEdit').onclick=e=>{if(e.target===document.getElementById('mEdit'))document.getElementById('mEdit').style.display='none';};
document.getElementById('editForm').onsubmit=async function(e){
  e.preventDefault();
  const id=document.getElementById('editId').value;
  const btn=document.getElementById('saveEditBtn');
  btn.disabled=true;btn.textContent='×©×•××¨...';
  try{
    await updateDoc(doc(db,'guests',id),{
      name:document.getElementById('editN').value.trim(),
      cat:document.getElementById('editCat').value,
      date:document.getElementById('editDt').value,
      time:document.getElementById('editTm').value,
      registeredBy:document.getElementById('editEmployee').value||'â€”',
    });
    document.getElementById('mEdit').style.display='none';
    toast('×¢×•×“×›×Ÿ ×‘×”×¦×œ×—×” âœ“','ok');
  }catch(err){toast('×©×’×™××”: '+err.message,'er');}
  btn.disabled=false;btn.textContent='×©××•×¨ ×©×™× ×•×™×™×';
};

// TENANTS SEARCH
function clrT(){document.getElementById('tSrch').value='';renderTenants();}
document.querySelectorAll('.stag').forEach(tag=>{
  tag.onclick=function(){
    tFld=this.dataset.f;
    document.querySelectorAll('.stag').forEach(t=>t.classList.remove('on'));
    this.classList.add('on');renderTenants();
  };
});
function renderTenants(){
  const s=document.getElementById('tSrch').value.trim();
  const sl=s.toLowerCase();
  const fl=document.getElementById('tFlr').value;
  const so=document.getElementById('tSort').value;
  let arr=tenants.filter(t=>{
    let ok=true;
    if(s){
      if(tFld==='name')ok=t.name.toLowerCase().includes(sl);
      else if(tFld==='phone')ok=!!(t.phone&&t.phone.includes(s));
      else if(tFld==='apt')ok=t.apt.includes(s);
      else if(tFld==='floor')ok=String(t.floor)===s;
      else ok=t.name.toLowerCase().includes(sl)||t.apt.includes(s)||String(t.floor)===s||(t.phone&&t.phone.includes(s));
    }
    return ok&&(!fl||String(t.floor)===fl);
  });
  arr.sort((a,b)=>{
    if(so==='name')return a.name.localeCompare(b.name,'he');
    if(so==='apt')return parseInt(a.apt)-parseInt(b.apt);
    return a.floor-b.floor||parseInt(a.apt)-parseInt(b.apt);
  });
  document.getElementById('tCnt').textContent=`××¦×™×’ ${arr.length} ××ª×•×š ${tenants.length}`;
  document.getElementById('tTbl').innerHTML=arr.length
    ?arr.map(t=>{
      const nm=s?hl(t.name,s):t.name;
      const ph=t.phone?(s?hl(t.phone,s):t.phone):'<span style="color:var(--t3)">â€”</span>';
      const ap=s?hl(t.apt,s):t.apt;
      return`<tr><td><strong>${nm}</strong></td><td>×§×•××” ${t.floor}</td><td>${ap}</td><td>${ph}</td></tr>`;
    }).join('')
    :'<tr><td colspan="4" class="ec">×œ× × ××¦××• ×“×™×™×¨×™×</td></tr>';
}
document.getElementById('tSrch').addEventListener('input',renderTenants);
document.getElementById('tFlr').addEventListener('change',renderTenants);
document.getElementById('tSort').addEventListener('change',renderTenants);

// TABS
document.querySelectorAll('.tab').forEach(t=>{
  t.onclick=function(){
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('on'));
    document.querySelectorAll('.sec').forEach(x=>x.classList.remove('on'));
    t.classList.add('on');
    document.getElementById('tab-'+t.dataset.tab).classList.add('on');
    if(t.dataset.tab==='tenants')renderTenants();
    if(t.dataset.tab==='list')renderGuestsList();
  };
});
</script>
</body>
</html>